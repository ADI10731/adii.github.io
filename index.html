<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DCET 2026 Mega App</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
        :root {
            /* Light Theme */
            --bg-grad: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
            --glass-bg: rgba(255, 255, 255, 0.9);
            --text-main: #2d3436;
            --text-sec: #636e72;
            --accent: #6c5ce7;
            --card-border: rgba(255,255,255,0.6);
            --shadow: 0 15px 35px rgba(0,0,0,0.1);
            --input-bg: #f1f2f6;
            --success: #00b894;
        }

        [data-theme="dark"] {
            /* Dark Theme */
            --bg-grad: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            --glass-bg: rgba(30, 39, 46, 0.9);
            --text-main: #ffffff;
            --text-sec: #b2bec3;
            --accent: #00d2d3;
            --card-border: rgba(255,255,255,0.1);
            --shadow: 0 15px 35px rgba(0,0,0,0.5);
            --input-bg: #2d3436;
        }

        * { box-sizing: border-box; transition: background 0.3s, color 0.3s; }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-grad);
            margin: 0;
            min-height: 100vh;
            color: var(--text-main);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- PRELOADER --- */
        #preloader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.5s;
        }
        .loader { width: 50px; height: 50px; border: 5px solid #ddd; border-top-color: #6c5ce7; border-radius: 50%; animation: spin 1s infinite linear; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- NAVBAR --- */
        .navbar {
            width: 100%; padding: 15px 30px;
            display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(10px); background: rgba(0,0,0,0.1);
            position: fixed; top: 0; z-index: 100;
        }
        .logo-area { display: flex; align-items: center; gap: 10px; font-weight: 900; font-size: 1.1rem; }
        .logo-img { width: 35px; height: 35px; border-radius: 8px; background: var(--accent); display: flex; align-items: center; justify-content: center; color: white; }
        .theme-toggle { cursor: pointer; font-size: 1.2rem; padding: 8px; background: rgba(255,255,255,0.2); border-radius: 50%; }

        /* --- MAIN CONTAINER --- */
        .app-container {
            margin-top: 90px; width: 95%; max-width: 550px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            padding: 2rem; border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: var(--shadow);
            animation: slideUp 0.8s ease;
            position: relative;
        }

        h1 {
            text-align: center; font-weight: 900; font-size: 2rem; margin: 0;
            background: linear-gradient(90deg, #6c5ce7, #00d2d3);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .signature { text-align: center; margin-bottom: 20px; font-size: 0.8rem; font-weight: 700; opacity: 0.8; letter-spacing: 1px; }

        /* --- INPUTS --- */
        .input-group { margin-bottom: 15px; }
        label { font-size: 0.85rem; font-weight: 600; color: var(--text-sec); display: block; margin-bottom: 5px; }
        
        input, select {
            width: 100%; padding: 14px; border-radius: 12px; border: none;
            background: var(--input-bg); color: var(--text-main);
            font-family: 'Outfit', sans-serif; font-size: 1rem; font-weight: 600;
        }
        input:focus, select:focus { outline: 2px solid var(--accent); background: var(--glass-bg); }

        .slider-wrapper { margin-top: 5px; }
        input[type="range"] { height: 5px; background: #dfe6e9; padding: 0; }
        
        .swap-btn { text-align: center; margin: -5px 0 10px; cursor: pointer; color: var(--text-sec); font-size: 1.2rem; }
        .swap-btn:hover { color: var(--accent); transform: scale(1.1); }

        /* --- BUTTONS --- */
        .primary-btn {
            width: 100%; padding: 16px; border: none; border-radius: 14px;
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
            color: white; font-size: 1.1rem; font-weight: 800; cursor: pointer;
            box-shadow: 0 10px 20px rgba(108, 92, 231, 0.3); margin-top: 10px;
            transition: transform 0.2s;
        }
        .primary-btn:hover { transform: translateY(-3px); }

        /* --- RESOURCES SECTION --- */
        .resources-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 30px;
        }
        .resource-card {
            background: var(--input-bg); padding: 15px; border-radius: 15px;
            text-align: center; cursor: pointer; border: 1px solid transparent;
            text-decoration: none; color: var(--text-main); display: block;
        }
        .resource-card:hover { border-color: var(--accent); transform: translateY(-3px); }
        .res-icon { font-size: 1.5rem; margin-bottom: 5px; color: var(--accent); }
        .res-title { font-size: 0.9rem; font-weight: 700; }

        .telegram-btn {
            grid-column: span 2; background: #229ED9; color: white;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .telegram-btn .res-icon { color: white; margin: 0; }

        /* --- COMMUNITY POLL --- */
        .poll-section {
            margin-top: 40px; background: var(--glass-bg); padding: 20px;
            border-radius: 20px; border: 1px solid var(--card-border);
        }
        .poll-header { font-size: 1.2rem; font-weight: 800; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        
        .poll-window {
            margin-top: 20px; height: 200px; overflow-y: auto;
            background: var(--input-bg); border-radius: 12px; padding: 10px;
            border: 1px solid rgba(0,0,0,0.05);
        }
        .student-row {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--glass-bg); padding: 10px; border-radius: 8px;
            margin-bottom: 8px; border-left: 3px solid var(--accent);
            animation: fadeIn 0.5s ease;
        }
        .st-name { font-weight: 700; font-size: 0.9rem; }
        .st-branch { font-size: 0.8rem; opacity: 0.8; }
        .st-cgpa { font-weight: 700; color: var(--success); background: rgba(0, 184, 148, 0.1); padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; }

        /* --- RESULTS --- */
        #rank-card {
            display: none; margin-top: 30px; text-align: center;
            background: var(--input-bg); padding: 2rem; border-radius: 20px;
            border: 2px solid var(--accent); animation: popIn 0.5s ease;
        }
        .rank-big { font-size: 3rem; font-weight: 900; background: linear-gradient(45deg, var(--accent), #ff7675); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* --- COLLEGE LIST --- */
        #college-section { display: none; width: 100%; max-width: 1100px; margin: 40px 0; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .branch-col { background: var(--glass-bg); padding: 1.5rem; border-radius: 20px; border: 1px solid var(--card-border); }
        .clg-item { background: var(--input-bg); padding: 10px; border-radius: 10px; margin-bottom: 8px; border-left: 4px solid #555; }
        .safe { border-left-color: var(--success); } .risk { border-left-color: #fdcb6e; }

        /* --- TOAST --- */
        #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 50px; padding: 16px; position: fixed; z-index: 1000; left: 50%; bottom: 30px; transform: translateX(-50%); }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }

        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body data-theme="light">

    <div id="preloader"><div class="loader"></div></div>
    <div id="toast"></div>

    <nav class="navbar">
        <div class="logo-area">
            <div class="logo-img"><i class="fa-solid fa-graduation-cap"></i></div>
            <span>DCET 2026</span>
        </div>
        <div class="theme-toggle" onclick="toggleTheme()"><i class="fa-solid fa-moon" id="theme-icon"></i></div>
    </nav>

    <div class="app-container" id="capture-area">
        <h1>DCET PREDICTOR</h1>
        <div class="signature">TRAINED BY ADITHYA ðŸ˜Ž</div>

        <div class="input-group">
            <label>Diploma CGPA</label>
            <input type="number" id="cgpa" placeholder="e.g. 9.75" step="0.01" oninput="toPercent()">
        </div>
        <div class="swap-btn" title="Convert">â‡…</div>
        <div class="input-group">
            <label>Diploma Percentage (%)</label>
            <input type="number" id="percent" placeholder="e.g. 90.00" step="0.01" oninput="toCgpa()">
        </div>
        <div class="input-group">
            <label style="display:flex; justify-content:space-between;">Expected Marks <span id="marks-val" style="color:var(--accent)">85</span></label>
            <input type="number" id="marks" value="85" oninput="syncSlider(this.value)">
            <div class="slider-wrapper">
                <input type="range" id="marks-slider" min="0" max="100" value="85" oninput="syncInput(this.value)">
            </div>
        </div>

        <button class="primary-btn" onclick="predict()">PREDICT RANK ðŸš€</button>

        <div id="rank-card">
            <div style="font-size:0.8rem; letter-spacing:2px; text-transform:uppercase;">Estimated Rank</div>
            <div class="rank-big" id="rank-display">---</div>
            <div>Merit Score: <b id="score-display">0.00</b></div>
            <div style="margin-top:15px; display:flex; gap:10px;">
                <button class="primary-btn" style="margin:0; background:#333;" onclick="downloadResult()"><i class="fa-solid fa-camera"></i> Save</button>
            </div>
        </div>

        <div class="resources-grid">
            <a href="https://drive.google.com/drive/folders/1dSVWAgyCqh_ZWZReRiWrNcdAvTfjEiiH" target="_blank" class="resource-card">
                <div class="res-icon"><i class="fa-solid fa-book-open"></i></div>
                <div class="res-title">Official Notes</div>
            </a>
            <a href="https://drive.google.com/drive/folders/1a3TzS4Jqi_bxzHChLWLnTzk5OgOSdt97" target="_blank" class="resource-card">
                <div class="res-icon"><i class="fa-solid fa-pen-nib"></i></div>
                <div class="res-title">Handwritten Notes</div>
            </a>
            <a href="https://t.me/dcet26" target="_blank" class="resource-card telegram-btn">
                <div class="res-icon"><i class="fa-brands fa-telegram"></i></div>
                <div class="res-title">Join DCET26 Army</div>
            </a>
        </div>
    </div>

    <div class="app-container" style="margin-top: 30px;">
        <div class="poll-header"><i class="fa-solid fa-users"></i> Live Aspirant Board</div>
        <div class="input-group">
            <input type="text" id="poll-name" placeholder="Your Name">
        </div>
        <div class="input-group" style="display:flex; gap:10px;">
            <select id="poll-branch">
                <option value="CSE">CSE</option>
                <option value="AIML">AIML</option>
                <option value="EC">E&C</option>
                <option value="MECH">Mech</option>
                <option value="CIVIL">Civil</option>
            </select>
            <input type="number" id="poll-cgpa" placeholder="CGPA" step="0.01">
        </div>
        <button class="primary-btn" onclick="addStudent()">Join the List +</button>

        <div class="poll-window" id="student-list">
            <div class="student-row">
                <div><div class="st-name">Adithya (Admin)</div><div class="st-branch">CSE</div></div>
                <div class="st-cgpa">9.80</div>
            </div>
            <div class="student-row">
                <div><div class="st-name">Rohan K.</div><div class="st-branch">AIML</div></div>
                <div class="st-cgpa">9.25</div>
            </div>
        </div>
    </div>

    <div id="college-section">
        <div class="grid">
            <div class="branch-col">
                <div class="branch-title" style="color:#3498db"><i class="fa-solid fa-laptop-code"></i> CSE / ISE</div>
                <div id="cse-list"></div>
            </div>
            <div class="branch-col">
                <div class="branch-title" style="color:#e84393"><i class="fa-solid fa-robot"></i> AIML / AIDS</div>
                <div id="aiml-list"></div>
            </div>
            <div class="branch-col">
                <div class="branch-title" style="color:#f1c40f"><i class="fa-solid fa-microchip"></i> E & C</div>
                <div id="ec-list"></div>
            </div>
        </div>
    </div>

<script>
    // --- 1. DATA & LOGIC ---
    const colleges = [
        { name: "RV College (RVCE)", cse: 54, aiml: 42, ec: 49 },
        { name: "MSRIT Bangalore", cse: 145, aiml: 245, ec: 103 },
        { name: "PES Univ (RR)", cse: 255, aiml: 449, ec: 621 },
        { name: "UVCE Bangalore", cse: 137, aiml: 133, ec: 212 },
        { name: "BMSCE Basavanagudi", cse: 450, aiml: 690, ec: 110 },
        { name: "Dr. Ambedkar (AIT)", cse: 688, aiml: 1578, ec: 1243 },
        { name: "Dayananda Sagar", cse: 852, aiml: 707, ec: 954 },
        { name: "Bangalore Inst. Tech", cse: 867, aiml: 951, ec: 1276 },
        { name: "BMS Inst. Tech", cse: 1708, aiml: 1945, ec: 1332 },
        { name: "Nitte Meenakshi", cse: 1649, aiml: 1389, ec: 2371 },
        { name: "Sir MVIT", cse: 2073, aiml: 2708, ec: 5264 },
        { name: "RNSIT", cse: 1824, aiml: 2390, ec: 2239 },
        { name: "JSSATE", cse: 3619, aiml: 4134, ec: 2383 },
        { name: "CMRIT", cse: 2974, aiml: 4194, ec: 3002 },
        { name: "New Horizon", cse: 2133, aiml: 3917, ec: 2561 },
        { name: "Vidya Vikas Mysore", cse: 4828, aiml: 6000, ec: 3514 }
    ];

    const ranges = [
        { min: 91.8, label: "1 - 10" }, { min: 90.6, label: "11 - 20" },
        { min: 89.98, label: "21 - 30" }, { min: 89.5, label: "31 - 40" },
        { min: 89.1, label: "41 - 50" }, { min: 89.0, label: "51 - 60" },
        { min: 88.3, label: "61 - 70" }, { min: 88.0, label: "71 - 80" },
        { min: 87.8, label: "81 - 90" }, { min: 87.6, label: "91 - 100" },
        { min: 86.9, label: "100 - 125" }, { min: 86.5, label: "126 - 150" },
        { min: 86.2, label: "151 - 175" }, { min: 85.5, label: "176 - 200" },
        { min: 84.6, label: "200 - 250" }, { min: 84.0, label: "250 - 300" },
        { min: 82.7, label: "300 - 400" }, { min: 81.5, label: "400 - 500" },
        { min: 79.6, label: "500 - 750" }, { min: 77.6, label: "750 - 1000" },
        { min: 75.6, label: "1000 - 1250" }, { min: 72.5, label: "1250 - 1750" },
        { min: 67.9, label: "1750 - 3000" }, { min: 0, label: "3000+" }
    ];

    // --- 2. INIT ---
    window.onload = function() {
        setTimeout(() => { document.getElementById('preloader').style.display = 'none'; }, 800);
    };

    function toggleTheme() {
        const body = document.body;
        const icon = document.getElementById('theme-icon');
        if (body.getAttribute('data-theme') === 'light') {
            body.setAttribute('data-theme', 'dark');
            icon.className = 'fa-solid fa-sun';
            showToast("Dark Mode Activated ðŸŒ™");
        } else {
            body.setAttribute('data-theme', 'light');
            icon.className = 'fa-solid fa-moon';
            showToast("Light Mode Activated â˜€ï¸");
        }
    }

    // --- 3. CORE FUNCTIONS ---
    function syncInput(val) {
        document.getElementById('marks').value = val;
        document.getElementById('marks-val').innerText = val;
        if(document.getElementById('percent').value) predict();
    }
    function syncSlider(val) {
        document.getElementById('marks-slider').value = val;
        document.getElementById('marks-val').innerText = val;
    }
    function toPercent() {
        let v = parseFloat(document.getElementById('cgpa').value);
        if(!isNaN(v)) document.getElementById('percent').value = ((v * 10) - 7.5).toFixed(2);
    }
    function toCgpa() {
        let v = parseFloat(document.getElementById('percent').value);
        if(!isNaN(v)) document.getElementById('cgpa').value = ((v + 7.5) / 10).toFixed(2);
    }

    function predict() {
        let p = parseFloat(document.getElementById('percent').value);
        let m = parseFloat(document.getElementById('marks').value);
        if(isNaN(p) || isNaN(m)) { showToast("Enter details!"); return; }

        let merit = (p / 2) + (m / 2);
        let rankLabel = "3000+";
        let maxRank = 5000;

        for(let r of ranges) {
            if(merit >= r.min) {
                rankLabel = r.label;
                let parts = r.label.split('-');
                maxRank = parseInt(parts.length > 1 ? parts[1] : parts[0]);
                break;
            }
        }

        if(maxRank <= 500) triggerConfetti();
        document.getElementById('rank-display').innerText = rankLabel;
        document.getElementById('score-display').innerText = merit.toFixed(2);
        document.getElementById('rank-card').style.display = 'block';
        renderColleges(maxRank);
        document.getElementById('college-section').style.display = 'block';
        
        document.getElementById('rank-card').scrollIntoView({behavior: 'smooth'});
    }

    function renderColleges(rank) {
        let cseH="", aimlH="", ecH="";
        colleges.forEach(clg => {
            cseH += getRow(clg.name, clg.cse, rank);
            aimlH += getRow(clg.name, clg.aiml, rank);
            ecH += getRow(clg.name, clg.ec, rank);
        });
        document.getElementById('cse-list').innerHTML = cseH || "<small>No safe options.</small>";
        document.getElementById('aiml-list').innerHTML = aimlH || "<small>No safe options.</small>";
        document.getElementById('ec-list').innerHTML = ecH || "<small>No safe options.</small>";
    }

    function getRow(name, cutoff, rank) {
        if (rank > cutoff + (cutoff * 0.15)) return ""; 
        let isSafe = rank <= cutoff;
        return `
            <div class="clg-item ${isSafe ? 'safe' : 'risk'}">
                <div>${name}</div>
                <div style="text-align:right">
                    <div style="font-size:0.75rem; opacity:0.7">Cutoff: ${cutoff}</div>
                    <div style="font-size:0.8rem; font-weight:700; color:${isSafe?'#00b894':'#fdcb6e'}">
                        ${isSafe ? 'Safe' : 'Borderline'}
                    </div>
                </div>
            </div>`;
    }

    // --- 4. POLL SYSTEM ---
    function addStudent() {
        let name = document.getElementById('poll-name').value;
        let branch = document.getElementById('poll-branch').value;
        let cgpa = document.getElementById('poll-cgpa').value;

        if(!name || !cgpa) { showToast("Please fill all poll fields!"); return; }

        let html = `
            <div class="student-row">
                <div><div class="st-name">${name}</div><div class="st-branch">${branch}</div></div>
                <div class="st-cgpa">${cgpa}</div>
            </div>
        `;
        let list = document.getElementById('student-list');
        list.innerHTML = html + list.innerHTML;
        
        document.getElementById('poll-name').value = "";
        document.getElementById('poll-cgpa').value = "";
        showToast("Added to List! ðŸŽ‰");
    }

    // --- 5. UTILS ---
    function showToast(msg) {
        let x = document.getElementById("toast");
        x.innerText = msg; x.className = "show";
        setTimeout(() => { x.className = x.className.replace("show", ""); }, 3000);
    }
    function triggerConfetti() {
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    }
    function downloadResult() {
        html2canvas(document.getElementById("capture-area")).then(canvas => {
            let link = document.createElement('a');
            link.download = 'DCET_Rank.png';
            link.href = canvas.toDataURL();
            link.click();
            showToast("Saved to Gallery! ðŸ“¸");
        });
    }
</script>

</body>
</html>
